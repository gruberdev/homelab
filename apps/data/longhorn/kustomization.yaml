apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - base/set-range.yaml
  - https://raw.githubusercontent.com/longhorn/longhorn/v1.2.5/deploy/longhorn.yaml

patchesStrategicMerge:
  - overlay/set-resources.yaml
  - overlay/daemon-sa.yaml

namespace: longhorn-system

patchesJson6902:
  - target:
      version: v1
      kind: LimitRange
      name: limit-range
    patch: |-
      - op: add
        path: /spec/limits/1/default/cpu
        value: 500m
      - op: add
        path: /spec/limits/1/default/memory
        value: 500Mi
      - op: add
        path: /spec/limits/1/defaultRequest/cpu
        value: 10m
      - op: add
        path: /spec/limits/1/defaultRequest/memory
        value: 100Mi
      - op: add
        path: /spec/limits/0/maxLimitRequestRatio/cpu
        value: "500"
      - op: add
        path: /spec/limits/0/maxLimitRequestRatio/memory
        value: "100"
      - op: add
        path: /spec/limits/1/maxLimitRequestRatio/cpu
        value: "500"
      - op: add
        path: /spec/limits/1/maxLimitRequestRatio/memory
        value: "100"
      - op: add
        path: /spec/limits/0/min/cpu
        value: 1m
      - op: add
        path: /spec/limits/0/min/memory
        value: 5Mi
      - op: add
        path: /spec/limits/1/min/cpu
        value: 1m
      - op: add
        path: /spec/limits/1/min/memory
        value: 5Mi
