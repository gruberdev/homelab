apiVersion: pxc.percona.com/v1
kind: PerconaXtraDBCluster
metadata:
  name: monica-cluster
spec:
  crVersion: 1.12.0
  secretsName: monica-db
  allowUnsafeConfigurations: true
  upgradeOptions:
    apply: disabled
    schedule: "0 4 * * *"
  pxc:
    size: 1
    image: percona/percona-xtradb-cluster:8.0.29-21.1
    readinessProbes:
      initialDelaySeconds: 15
      timeoutSeconds: 15
      periodSeconds: 30
      successThreshold: 1
      failureThreshold: 5
    livenessProbes:
      initialDelaySeconds: 300
      timeoutSeconds: 5
      periodSeconds: 10
      successThreshold: 1
      failureThreshold: 3
    resources:
      requests:
        memory: 256Mi
        cpu: 100m
      limits:
        memory: 512Mi
        cpu: 350m
    volumeSpec:
      persistentVolumeClaim:
        storageClassName: iscsi
        accessModes: ["ReadWriteMany"]
        resources:
          requests:
            storage: 2G
  haproxy:
    enabled: true
    size: 1
    image: percona/percona-xtradb-cluster-operator:1.12.0-haproxy
    readinessDelaySec: 15
    livenessDelaySec: 600
    resources:
      requests:
        memory: 128Mi
        cpu: 80m
      limits:
        memory: 425Mi
        cpu: 230m
  logcollector:
    enabled: true
    image: percona/percona-xtradb-cluster-operator:1.12.0-logcollector
    resources:
      requests:
        memory: 120Mi
        cpu: 80m
